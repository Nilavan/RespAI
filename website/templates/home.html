{% extends "base.html" %} {% block title %}Home{% endblock %} {% block content
%}
<head>
  <style>
    .item1 {
      grid-area: header;
    }
    .item2 {
      grid-area: main;
    }
    .item3 {
      grid-area: right;
    }

    .grid-container {
      display: grid;
      grid-template-areas:
        "header header header header"
        "main main right right"
        "footer footer footer footer";
      grid-gap: 2%;
      padding: 2%;
    }

    .grid-container > div {
      text-align: center;
      padding: 2%;
      font-size: large;
    }

    .results {
      background-color: aquamarine;
    }
    img {
      text-indent: -10000px;
    }
  </style>
</head>
<body>
  <div class="grid-container">
    <div class="item1"><h1 align="center">COVID-19/PNEUMONIA TESTING</h1></div>
    <div class="item2">
      <form method="post" enctype="multipart/form-data">
        <div class="row">
          <label class="col" for="name" align="left"
            >Patient Name: &nbsp;</label
          >
          <input
            class="col"
            type="text"
            name="name"
            id="name"
            placeholder="{{ patient }}"
          /><br />
        </div>
        <br />
        <div class="row">
          <label class="col" for="phone" align="left"
            >Patient's phone number: &nbsp;</label
          >
          <input
            class="col"
            type="tel"
            name="phone"
            id="phone"
            placeholder="{{ phone }}"
          /><br />
        </div>
        <br />
        <input
          class="m-7 btn btn-outline-info"
          id="image-selector"
          type="file"
          name="file"
          onchange="loadFile(event)"
        /><br />
        <div class="row m-7">
          <button id="predict-button" class="col m-3 btn btn-outline-primary">
            Predict
          </button>
          <button
            id="verify-button"
            class="col m-3 btn btn-outline-success"
            onclick="verify()"
            formmethod="get"
          >
            Verify
          </button>
        </div>
      </form>
      <div class="col p-5 results">
        <p class="row">
          Prediction:&nbsp;<span id="result">{{ result }}</span>
        </p>
        <p class="row">
          Probability:&nbsp;<span id="probability">{{ accuracy }}%</span>
        </p>
      </div>
    </div>
    <div class="item3">
      <h4>Selected Image</h4>
      <img align="right" id="selected-image" width="350" /><br />
      <img
        src="{{ url_for('views.display_image', filename=filename) }}"
        id="selected-image-placeholder"
        width="350"
        onerror="this.style.display = 'none'"
      />
    </div>
    <script>
      var loadFile = function (event) {
        var image = document.getElementById("selected-image");
        image.src = URL.createObjectURL(event.target.files[0]);
      };

      function verify() {
        let phone1 = document.getElementById("phone").value;
        let name1 = document.getElementById("name").value;
        let phone2 = document
          .getElementById("phone")
          .getAttribute("placeholder");
        let name2 = document.getElementById("name").getAttribute("placeholder");
        let name = name1 + name2;
        let phone = phone1 + phone2;
        let prediction = document.getElementById("result").textContent;
        let probability = document.getElementById("probability").textContent;
        if (prediction.length === 0) {
          let output = "Please get the prediction first";
          alert(output);
        } else {
          let output =
            "SMS sent to " +
            name +
            " - " +
            phone +
            "\nCOVID19/Pneumonia Result: " +
            probability +
            " chance of " +
            prediction;
          document.getElementById("name").placeholder = "";
          document.getElementById("phone").placeholder = "";
          alert(output);
        }
      }
    </script>
  </div>
</body>
{% endblock %}
